<ROSETTASCRIPTS>

 <SCOREFXNS>

 	<hard weights=talaris2014.wts >
 		<Reweight scoretype=aa_composition weight=1.0 />
 	</hard>

 	<soft weights=soft_rep_design>
 		<Reweight scoretype=aa_composition weight=1.0 />
 	</soft>

 	<hard_bb weights=talaris2014.wts >
 		<Reweight scoretype=coordinate_constraint weight=2. />
 		<Reweight scoretype=cart_bonded weight = 0.5 />
 		<Reweight scoretype=pro_close weight=0.0/>

 	</hard_bb>


 </SCOREFXNS>

 <TASKOPERATIONS>

 	<ReadResfile name="resfile"/>
 	<IncludeCurrent name=current/>
 	<LimitAromaChi2 name=arochi />
 	<ExtraRotamersGeneric name=ex1_ex2 ex1=1 ex2=1/>
	<ExtraRotamersGeneric name=ex1 ex1=1/>
 	
 	<LayerDesign name=all_layers layer=others >

 		<CombinedTasks name=symmetric_interface_core>
			<SelectBySASA state=bound mode=mc core=1 probe_radius=2.0 core_asa=35 surface_asa=45/>
			<all copy_layer=core />
			<Helix append="HYSTMV"/>
			<Helix exclude="W"/>
		</CombinedTasks>

		<CombinedTasks name=symmetric_interface_boundary>
			<SelectBySASA state=bound mode=mc boundary=1 probe_radius=2.0 core_asa=35 surface_asa=45/>
 			<all copy_layer=boundary />
 			<Helix append="HNQYSTV"/>
 			<Helix exclude="DKRWE"/>
 		</CombinedTasks>

		<CombinedTasks name=symmetric_interface_surface>
			<SelectBySASA state=bound mode=mc surface=1 probe_radius=2.0 core_asa=35 surface_asa=45/>
			<all copy_layer=surface />
		</CombinedTasks>
 
 
 	</LayerDesign>

 <SelectBySASA name=select_core state=bound mode=mc core=1 probe_radius=2.0 core_asa=35 surface_asa=45/>
 <SelectBySASA name=select_boundary state=bound mode=mc boundary=1 probe_radius=2.0 core_asa=35 surface_asa=45 />
 <SelectBySASA name=select_surface state=bound mode=mc surface=1 probe_radius=2.0 core_asa=35 surface_asa=45 />
 <RestrictAbsentCanonicalAAS name=ala_only resnum=0 keep_aas="A" />
 

 </TASKOPERATIONS>


 <FILTERS>

 	<ShapeComplementarity name=sc_filter min_sc=0.5 jump=1 write_int_area=1 confidence=1 verbose=1/>
 	<PackStat name=packstat threshold=0.4 confidence=1/>
 	<BuriedUnsatHbonds name=uhb scorefxn=hard task_operations=select_core,select_boundary,select_surface confidence=0/>

 </FILTERS>

 <MOVERS>
 	<PackRotamersMover name=transform_sc scorefxn=hard task_operations=ala_only/>
 	<ConstraintSetMover name="add_cst" cst_file="%%cst_file%%"/>
 	<MinMover name=hardmin_bb scorefxn=hard_bb type=lbfgs_armijo_nonmonotone tolerance=0.0001 chi=1 bb=1 bondangle=1 bondlength=1 jump=all cartesian=1/>

 	<ClearConstraintsMover name=clearconstraints/>

 	<AddCompositionConstraintMover name=addcomp1 filename='%%comp_file%%' />

 	<PackRotamersMover name=softpack_core scorefxn=soft task_operations=resfile,all_layers,select_core,current,arochi/>
 	<PackRotamersMover name=softpack_boundary scorefxn=soft task_operations=resfile,all_layers,select_boundary,current,arochi/>
	<PackRotamersMover name=softpack_surface scorefxn=soft task_operations=resfile,all_layers,select_surface,current,arochi/>

	<PackRotamersMover name=hardpack_core scorefxn=hard task_operations=resfile,all_layers,select_core,current,arochi,ex1_ex2/>
	<PackRotamersMover name=hardpack_boundary scorefxn=hard task_operations=resfile,all_layers,select_boundary,current,arochi,ex1_ex2/>
	<PackRotamersMover name=hardpack_surface scorefxn=hard_ele task_operations=resfile,all_layers,select_surface,current,arochi,ex1_ex2/>
	
	<MinMover name=hardmin_sconly scorefxn=hard chi=1 bb=0 bondangle=0 bondlength=0/>

 </MOVERS>

 <APPLY_TO_POSE>
 </APPLY_TO_POSE>

 <PROTOCOLS>

 	<Add mover=transform_sc/>
 	<Add mover=add_cst/>
 	<Add mover=hardmin_bb/>
 	<Add mover=clearconstraints/>

 	<Add mover=addcomp1/>
 	<Add mover=softpack_core/>
 	<Add mover=softpack_boundary/>
 	<Add mover=softpack_surface/>
 	<Add mover=hardmin_sconly/>
 	<Add mover=hardpack_core/>
 	<Add mover=hardpack_boundary/>
 	<Add mover=hardpack_surface/>
	<Add filter=packstat/>
 	<Add filter=sc_filter/>
 	<Add filter=uhb/>

 </PROTOCOLS>

</ROSETTASCRIPTS>